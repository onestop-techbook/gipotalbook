# サークルページのリファクタリングとAPIアクセスの下準備をした

今回は前回まとめた「次回やること」に着手しました。
とはいえ、常連のメンバーがおやすみのため普段とは異なる形でモブワーク・モブプロを行いました。

## Vscode Live Shareの設定
普段のモブワークでドライバーを行うことの多いメンバーが不在のため、全員でコードを触れれるようにVScodeのアドオンである「Live Share」を設定しました。
そうすることで、画面共有を切り替えることなく全員で同じコードにてをいれることができるようになりました。
今回はこのLive Share機能を使ってコードの加筆修正を行っていきます。

## サークルページのリファクタリング
本来は「APIでデータにアクセスすること」がやることでしたが、フロントのコードを見て、まずはリファクタリングをすることになりました。
現在のコードの状況が、Main関数に処理をもたせすぎて太っているのが理由とのこと。
また、Reactのカスタムフックを利用することでMain関数での処理を少なく、スマートにできるとのことでした。

## DBのテーブルリレーション設定修正
リファクタリングが終わったので、そのままGraphQLでのクエリ生成を行うつもりでしたが、DBのリレーションが想定と異なっていたので、リレーションの整理を行いました。
サークルテーブルとサークル情報テーブルのリレーションを紐付けが抜けていたため、設定しなおすことで、サークルページにサークルの情報と同人誌の情報を載せれるようになりました。

## GraphQLでデータ取得クエリを書く
ここで予定通り、GraphQLでサークルデータ取得のクエリを書きます。
サークル名やサークル概要、同人誌の説明などをDBから取得できるクエリを作成しました。
そして、上記で作成したクエリを基に、TypeScriptの型を生成します。

## APIアクセスの設定（途中）
API側の設定が住んだので、今度はアクセスを試みましたが、今回はうまくいきませんでした。
次回への残課題としてAPIアクセスはしておきましょう。